<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <div class="container" id="iframeContainer">
        <!-- <iframe src="https://storymaps.arcgis.com/collections/bf84e6ebd1c2456a9cdc721779043c01" height="1000" width="2400" class="responsive-iframe"></iframe> -->
        <iframe id="fullscreenIframe" class="responsive-iframe" src="https://storymaps.arcgis.com/collections/bf84e6ebd1c2456a9cdc721779043c01" frameborder="0" allowfullscreen allow="geolocation"></iframe>
    </div>
</body>

<style>
    body {
        padding: 0;
        margin: 0;
    }
    
    .container {
        position: relative;
        overflow: hidden;
        width: 100%;
        padding-top: 56.25%;
        /* 16:9 Aspect Ratio (divide 9 by 16 = 0.5625) */
    }
    /* Then style the iframe to fit in the container div with full height and width */
    
    .responsive-iframe {
        position: absolute;
        top: -10;
        left: 0;
        bottom: 0;
        right: 0;
        width: 100%;
        height: 100%;
        border: none;
    }
</style>


<script>
    // Get references to the necessary elements
    const iframeContainer = document.getElementById('iframeContainer');
    const fullscreenIframe = document.getElementById('fullscreenIframe');

    // Handle the popstate event when the user navigates using the browser history
    window.addEventListener('popstate', () => {
        // Check if the iframe is currently open
        if (iframeContainer.classList.contains('active')) {
            // Hide the iframe container
            iframeContainer.classList.remove('active');

            // Clear the iframe source to stop loading the content
            fullscreenIframe.src = '';

            // Update the browser history
            history.pushState(null, null, '');
        }
    });

    // Handle the popstate event within the iframe
    fullscreenIframe.addEventListener('load', () => {
        const iframeHistory = fullscreenIframe.contentWindow.history;
        iframeHistory.pushState = iframeHistory.pushState || function() {};
        iframeHistory.replaceState = iframeHistory.replaceState || function() {};

        // Hijack iframe's history.pushState method
        fullscreenIframe.contentWindow.history.pushState = function(state, title, url) {
            // Update the iframe's history
            iframeHistory.pushState.call(iframeHistory, state, title, url);

            // Update the browser's history to reflect the iframe's URL
            history.pushState(state, title, url);
        };

        // Hijack iframe's history.replaceState method
        fullscreenIframe.contentWindow.history.replaceState = function(state, title, url) {
            // Update the iframe's history
            iframeHistory.replaceState.call(iframeHistory, state, title, url);

            // Update the browser's history to reflect the iframe's URL
            history.replaceState(state, title, url);
        };

        // Handle the popstate event within the iframe
        fullscreenIframe.contentWindow.addEventListener('popstate', () => {
            // Update the browser's history to reflect the iframe's URL
            history.go();
        });
    });

    // Show the iframe container by default
    iframeContainer.classList.add('active');

    // Load the desired URL in the iframe
    // fullscreenIframe.src = 'https://example.com';

    // Update the browser history
    history.pushState(null, null, '?iframe=open');
</script>

</html>